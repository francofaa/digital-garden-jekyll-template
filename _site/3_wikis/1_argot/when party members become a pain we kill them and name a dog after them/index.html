<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="UTF-8">

 <link href="https://fonts.googleapis.com/css2?family=Grenze&family=Grenze+Gotisch:wght@100;200;300;400;500;600;700;800;900&family=Vollkorn:ital,wght@0,400;0,500;0,600;0,700;0,900;1,400;1,500;1,600;1,800;1,900&display=swap" rel="stylesheet">   

  <link rel="canonical" href="http://localhost:4000/3_wikis/1_argot/when%20party%20members%20become%20a%20pain%20we%20kill%20them%20and%20name%20a%20dog%20after%20them/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <meta name="description" content="Franco’s Wikis">

  <meta property="og:site_name" content="Franco’s Wikis">

  <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgo=">

  <link rel="stylesheet" href="/styles.css">

  
  <meta property="og:description" content="Franco’s Wikis"/>
  

  
  <meta property="og:title" content="when party members become a pain we kill them and name a dog after them">
  <meta property="og:type" content="article">
  

  

  <meta property="og:url" content="http://localhost:4000/3_wikis/1_argot/when%20party%20members%20become%20a%20pain%20we%20kill%20them%20and%20name%20a%20dog%20after%20them/" />

  

  <title>
    
      when party members become a pain we kill them and name a dog after them &mdash; Franco’s Wikis
    
  </title>
</head>

  <body>
    <nav><div>
    <a class="internal-link" href="/"><b>Franco’s Wikis</b></a>
</div>
</nav>
    <div class="wrapper">
      <main><article>
  <div>
    <h1>when party members become a pain we kill them and name a dog after them</h1>
    <time datetime="2021-05-14T23:21:46-04:00">
      Last updated on May 14, 2021
      
    </time>
  </div>

  <div id="notes-entry-container">
    <content>
      <h1 id="short-king-big-woman">Short king, big woman</h1>

<p>Sora, skimming the Duchess’s mind, smells desperation, and to Sora, that smells like an opportunity. She throws caution to the wind and invades the Duchess’s mind, finding a giantess desperate to cobble together support, desperate to undermine her king and queen after ruthlessly murdering their son, desperate to craft a world in her own image.</p>

<p>Seized in a telekinetic grip, the powerful giantess hears Sora out and notes her veiled threats of revealing who truly killed Prince Riffrick. Kalak, the Nemmonis Clan elder, rebuffed by Sora in his offering of help, quietly resigns once more to the power of the Nistora Cloud Giants. Duchess Serena is intrigued and perhaps her hand is forced, and she agrees to chat with Sora, alone, the dragonborn unarmed, facing down the giant.</p>

<p>Sora, in her years of spycraft and her time in Argot, the flawed democracy, is used to small evils. Facing down the heft of the giantess’s morningstar, Sora knows one thing. She wants to survive. She divulges their plan to track down the final key and break open the demiplane into the material plane that Serena has only heard stories of. Serena offers as a consolation that she does not mean to continue the raiding and slaving that Riffrick was notorious for.</p>

<p>“He was loud and messy.” And Sora has witnessed firsthand the subtle menace of the Duchess’s methods with Kalak. And she has seen as well what such regimes can do, what such regimes can turn into. The Werriadi Republic is just on Argot’s doorstep and, thanks to her, practically in their Assembly. Hespero did not tell Sora how the war was going in Argot on the material plane when they were present together for the Icosahedradome, but Sora hopes her spymaster is holding up his end of the bargain she made so long ago.</p>

<p>Sora, powerless to stop the Duchess’s nascent empire in its cradle, offers a truce: We leave you be, we give you Paloma, and help us take the key out of the Skyswimmer and you let me go so we can free the demiplane. Serena offers one better: “When I am on that throne and control these islands, I will help you with these foes of yours.”</p>

<p>Sora lights up at this. To stop her most hated enemies once and for all. Hespero, who betrayed her and her friends to the courts of Argot. The Deathless One, who banished them without a single thought. Their ways are world-ending, their desires are all consuming, their actions careless and selfish and cruel. But Duchess Serena and King Almsbrood. Strangers both. Let these petty dictators play their games. She sees less harm in siding with the Duchess for now to inevitably betray her later. They fist bump and Sora plays at being a friend and ally. But of course, “We are what we pretend to be, so we must be careful about what we pretend to be.”<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup></p>

<p>Serena tells Sora to hang out while she sends her soldiers up to the ship. Unable to stop them, Sora agrees, and unbeknownst to her, Serena changes shape into her. The giant has more than just a morningstar at her disposal.</p>

<h1 id="whatever-happened-to-dirigibility">Whatever happened to dirigibility</h1>

<p>Meanwhile on the P.S. Admirable Effort, Nahk and the others celebrate the retrieval of the final key from the skyswimmer, no blood drawn or anything. Paloma smiles to know that they have succeeded, though she is unsure what it means for their truce, whether the gang will help them. And she’ll find out soon just what the past few hours have won her.</p>

<p>Serena, in the guise of Sora, appears before the heroes on a dirigible with giants, lightly bound. “Trade me for Paloma! Hurry! They won’t hurt you!”</p>

<p>The giants start hurling rocks at Paloma, who throws them right back, and meanwhile the heroes are unsure as to what to do. Rho sees an opportunity to be a damn hero. She leaps from the dirigible to vine whip across and save Sora, realizing in bullet time (whatever that is), that she had enough reach to vine whip from the ship.</p>

<h1 id="ballista-ballista-now-you-gotta-kiss-ta">Ballista ballista, now you gotta kiss-ta</h1>

<p>But she makes it! Sick! One of the giants seeks to come after Rho, but another stops him, reminding the other giant of Serena’s orders. Livius and Luigius blast the balloon on the dirigible. Casimir sets off some fireworks in the blaze, blinding two of the giants, and Salty Sabrina the weapons engineers trains her mangonel and ballista on the balloon, popping it. “Stole your kill, Livius! Got your ass!”</p>

<p>The heroes disable the balloon and don’t attack the giants themselves. Well, at least as far as I remember. KB protects Paloma and rebounds the attack onto the giant who hit her. The balloon slowly drifts down as Rho word of recalls herself with Serena, disguised as Sora, back to the ship.</p>

<p>The giants cast fly on themselves and abandon ship. Captain Barty steers the ship out of the way and books it in the direction of Charatos, trying to elude the Duchess’s forces and keep Paloma safe.</p>

<h1 id="its-like-diet-colonialism">It’s like diet colonialism</h1>

<p>Serena as Sora does not relish in the victory, calling it short-sighted. The heroes are confused, but she goes on, keeping Paloma in the dark while lying about her role in Riffrick’s murder. The others wonder why even entertain the Duchess’s deal, but Serena paints the bigger picture: A fleet of Cloud Giant dirigibles, striking at the Mineosi armies and ships. The destruction. The terror these giants could inflict on our own enemies. Serena tries to espouse her own virtues, giving her hard pitch, saying that imperialism isn’t as bad as slavery, but she is rebuffed. Why choose between two evils at all? Why play along? Aren’t we here for something else? Aren’t we here to free ourselves and free the people of the 13 Islands?</p>

<p>But the doubt is there. Paloma sits on the deck, alone, wondering what Sora is telling them, Sora who implored many times to trade them. The giantess waits alone. And the temptation is there. The power of the air fleet.</p>

<p>Nahk tells Sora, “We don’t even have to stay! We can go! We have the key.”</p>

<p>But of course they promised Paloma they would try to help, somehow, to find justice for her lord and clear the gang’s names and bring the Duchess to trial. And KB-180 protests as well, saying that the Kodama need the heroes to heal all of the islands before moving on. To rid them of the abominations that plague the island. All the while, belowdecks, the Alchemist contemplates the obsidian cube found in her tomb.</p>

<p>Nahk grills Sora about Paloma’s involvement in Riffrick’s murder, saying that it doesn’t add up based on how they found her. After relentless questioning, Serena as Sora gives in, saying that it was a small lie meant to bring them over, and Nahk turns away in disappointment, no longer wanting to debate the consequences of what any of their choices would bring. Serena as Sora emphasizes that Prince Riffrick was a slaver and Paloma was there the whole time, following orders, burning ships, stealing dogs, and killing. No big loss and a bigger win for a better future. A better future with the Duchess as the leader. Perhaps a bit overzealous, so Serena hushes up, tries to lay low, bide her time.</p>

<p>Rho in disbelief doesn’t understand why the others are even contemplating siding with the Duchess. Paloma is seeking redemption, even if it is just because she is at her lowest. Evil is evil and the islands need us. The people of the islands don’t need us to hand them over to the Duchess. They need freedom. They need to be broken from this prison.</p>

<h1 id="red-rover-red-rover-send-paloma-over">Red rover, red rover, send Paloma over</h1>

<p>The heroes all put in their ideas (Luigius just goes along with Livius’s suggestion, and he hasn’t made Waluigius yet to play tennis with so Luigius is just kind of there) and agree to first go with Livius’s idea to ask Paloma what she wants to do. Rho’s grace protects Paloma for a time, but the heroes decide to see what they can get out of the Duchess, depending on what Paloma says. Will she continue her ways as she had with Riffrick? “No. Small folk are people too. You saved my life.” They then try to convince her to join sides with the Duchess and turn against King Almsbrood.</p>

<p>But that is a step too far for her. Paloma of course refuses, heavy sadness in her eyes. Her honor will not allow her to side with Serena or betray King Almsbrood or let the murder of her liege lord stand or let the accusations against you stand, even if you will not speak for her. KB-180, looking at her like an army recruiter meeting a troubled teenager in the JROTC, offers her a role in the Kodama Battalion to devote her life to the Kodama’s service. “I’m good, thanks.”</p>

<p>The heroes offer to drop her off somewhere so that they may continue without being harassed by the Duchess. Paloma asks to be dropped off to challenge the Duchess in one-on-one combat, since she would not be able to refuse. The Duchess herself looks on, invisible and shape-changed.</p>

<p>The heroes agree to the terms while Rho looks on with disappointment. Another life thrown away. The promise of redemption for her crimes as Riffrick’s soldier. She did not want to betray Paloma, but none of them had any idea that Paloma would resort to this. They all consider Sora with distrust and shock, unaware of the rules of Serena’s game.</p>

<h1 id="im-turning-this-car-around">I’m turning this car around!</h1>

<p>Captain Barty steers back to Osteros at dusk. Duchess Serena’s dirigible is dark against the horizon red and bleeding across the sky. Serena as Sora takes off on Sora’s broom, does a quick change, and returns to face Paloma in a sky battle trial by combat. The heroes agree to remain neutral, all the while Rho racks her brain for any diamond sources to account for the worst.</p>

<p>In a vicious display of violence, the two giantesses float in mid-air, teleport around each other, swing their brutal weapons, until Paloma begins to tire and Serena connects her morningstar with Paloma’s skull. Her head crushed, her flight breaks, and she plummets to the sea.</p>

<p>Against the darkness of the sky, over the whipping winds, the Duchess calls out, “I thank you for your help! My soldiers were impressed by the power you small folk have. I will be clearing your name to the king and queen, now that we know Paloma was the true killer. And once you free us from this demiplane, I will come to your aid against the Deathless One. As agreed.”</p>

<p>Sora is plopped onto the ship as Serena chuckles and yanks the broom from her hand. The giants return to their ships and fly away. Petty thievery. Sora returns broomless in exchange for her life like how you traded the freedom of Iskos to Riffrick for some gold. Careless and cavalier both the Duchess and the Prince. A lesson is learned but the damage is irreversible and the Duchess returns to her scheming and her games.</p>

<p>“What did I miss?”</p>

<h1 id="diamond-status">Diamond status</h1>

<p>“Bring us down!” Rho shouts to the captain. “I need a diamond. To bring Paloma back.”</p>

<p>“Of course, of course!” Sora says, but everyone watches her with anxiety, the tension palpable between the two as she hands the diamond to Rho.</p>

<p>Once the ship is close enough, Rho forgets her fear of the ocean and dives into the water.</p>

<p>She swims deep until she finds Paloma’s hand and casts her spell. Paloma opens her mouth to scream, fear in her eyes and Rho swims up, holding the giantess until the shock of life returning goes down. Paloma screams, the trauma of death, the pain in her head suddenly gone but never really gone. The morningstar will be there forever. Rho speaks to her in a soothing Southern American accent, whatever that is, floating together like a pair of otters. She soothes Paloma as a way to soothe herself as the icy waves push her adrift and the sea stretches out for miles and miles in the utter darkness of night. But the cleric does what she always does, and when her patient has enough wherewithal to do so, they climb up the ropes of the ship.</p>

<p>Sora explains to the others what had happened. Hobbes laments, “Goddamn giants! No offense,” he adds to Paloma.</p>

<p>“None taken, small folk.”</p>

<p>“What do we do next?” they say, and none of them want to deal with the giants ever again. Paloma doesn’t suggest anything, knowing she is a guest, that she has been given a gift greater than anything. Her life was forfeit, and now it is hers again.</p>

<p>Sora brings up the benefits of the Duchess’s help, even if she did do they dirty. But Rho and Nahk and KB probably and Hobbes maybe, can’t remember who all thought what, but they do not agree. Choosing between the lesser of two evils is an illusion. Even though it had not been Sora who had spoken to them for the past several hours, it was as though something lingered within Sora from Serena.</p>

<p>But really it had been there all along, something Cas and Livius and Abe had seen often in Sora. She was a spy, serving the imperialist republic, under duress, yes, but she was good at her job. Only the common threat of the Deathless One had seen her change, but in the meeting with the Duchess, she saw only another tool that she was more than willing to pay for. “And best believe I will betray her ass as soon as she is no longer of use to me,” Sora adds, (paraphrasing).</p>

<p>Her friends could only worry that one day the price may become too great.</p>

<h1 id="the-real-encounter-was-the-ugliness-of-the-world-exposed-within-us-all">The real encounter was the ugliness of the world exposed within us all</h1>

<p>The Kodama may tell you that the source of evil lies within the abominations that cursed these islands, whose legacy can still be felt 600 years after the Hidimba crafted this vengeance and created this demiplane. They are wary and distrustful of the undead and the devils who locked them away in this world and left so many scars on its inhabitants and descendants. Six hundred years worth of people, living and dying imprisoned, never knowing what lay beyond, never knowing why they were doomed to being locked away, never knowing that their existence was cursed intentionally, though feeling cursed nonetheless.</p>

<p>The Hidimba and Aramestes wanted power, nothing less than absolute, and in their fury and vengeance, stopped at nothing. The feuding tibbit clans, the trapped fairies and their polluted fountain, the curse upon Natalya’s suitors and the endless winter that imprisoned Iskos, the desolation of Embara, the tempting allure of the lich tomb on Osteros. These tragedies and more are their legacies. All of those islands you have visited bear the scars of their game and have for 600 years.</p>

<p>“Look!” you hear Paloma cry out, her voice wheezing from nearly drowning so soon after returning to life. She points at the sky, and there it is.</p>

<p>You watch its golden starlit hide, its red fins, the great Skyswimmer snakes through the clouds, its eyes large and glowing. The creature, which you were so ready to kill, is indeed beautiful. The sacred beast moves around you, harmlessly, silhouetted against the shining moon. It pays you no mind, bears you no ill will, and perhaps scarcely registers that you are there. In spite of your losses and betrayals and setbacks, you realize that you have managed to thwart Hespero in at least one way. His petty cruelties and games and jokes have been the downfall of so many, 600 years worth of lives, but Nahk’s humble hobby saved this poor beast from the fate Hespero thought he had doomed it to, tying its fate to the fates of all those he imprisoned on the 13 Islands.</p>

<p>The sacred beast swims peacefully on until it disappears from view.</p>

<hr />

<p>It is late night on day 32 since the Battle of Aurochs Island, the first engagement in the Argoti-Mineosi War.</p>

<p>The heroes are flying above Osteros, bound for Charatos, having made a truce with the Duchess and resurrected Paloma (you win twice!)</p>

<p>The dogs are safe.</p>

<p>Three islands left: Nistora, Dorost, and Charatos.</p>

<p>All three keys have been retrieved.</p>

<p>Malory is on the material plane with <a class="internal-link" href="/3_wikis/1_argot/Characters/Hespero/">Hespero</a></p>

<p>Abraham and Baltsaros are on <span title="There is no note that matches this title." class="invalid-link">
  <span class="invalid-link-brackets">[[</span>
  Lemba
  <span class="invalid-link-brackets">]]</span></span></p>

<p>You have four solid cubes with keyholes and a ring of seven keys:</p>

<ul>
  <li>KB has one of the pine wood cubes</li>
  <li>Livius has the cube made of bone found in Iskos Valley Village’s elders’ hut</li>
  <li>The Alchemist has one of the pine wood cubes, the obsidian cube found at Natalya’s tomb, and the ring of seven keys</li>
</ul>

<p>You are on a demiplane, and Zulon has been on the material plane for one full day.</p>

<p>Previous Episode: <a class="internal-link" href="/3_wikis/1_argot/id%20like%20to%20eat%20something%20that%20tried%20to%20eat%20me/">id like to eat something that tried to eat me</a></p>

<p>Next Episode: <a class="internal-link" href="/3_wikis/1_argot/sirablood%20induced%20fantasy%20rabies/">sirablood induced fantasy rabies</a></p>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1" role="doc-endnote">
      <p>From <em>Mother Night</em> by Kurt Vonnegut, Jr., which is about a spy! <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>

    </content>

    <side style="font-size: 0.9em">
      <h3 style="margin-bottom: 1em">Notes mentioning this note</h3>
      

      <div style="font-size: 0.9em">
        <p>
          There are no notes linking to this note.
        </p>
      </div>
      
    </side>
  </div>
</article>

<hr>

<p>Here are all the notes in this wiki, along with their links, visualized as a graph.</p>

<style>
  .links line {
    stroke: #ccc;
    opacity: 0.5;
  }

  .nodes circle {
    cursor: pointer;
    fill: blue;
    transition: all 0.15s ease-out;
  }

  .text text {
    cursor: pointer;
    fill: #333;
    text-shadow: -1px -1px 0 #fafafabb, 1px -1px 0 #fafafabb, -1px 1px 0 #fafafabb, 1px 1px 0 #fafafabb;
  }

  .nodes [active],
  .text [active] {
    cursor: pointer;
    fill: red;
  }

  .nodes circle[active] {
    r: 6;
  }

  #graph-wrapper {
    background: #fafafa;
    border-radius: 4px;
    height: auto;
  }
</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.16.0/d3.min.js"
  integrity="sha512-FHsFVKQ/T1KWJDGSbrUhTJyS1ph3eRrxI228ND0EGaEp6v4a/vGwPWd3Dtd/+9cI7ccofZvl/wulICEurHN1pg=="
  crossorigin="anonymous"></script>

<div id="graph-wrapper">
  <script>
    const RADIUS = 4;
    const STROKE = 1;
    const FONT_SIZE = 15;
    const TICKS = 100;
    const FONT_BASELINE = 15;
    const MAX_LABEL_LENGTH = 50;

    const graphData = {"edges":[],"nodes":[]}

    let nodesData = graphData.nodes;
    let linksData = graphData.edges;

    const onClick = (d) => {
      window.location = d.path
    };

    const element = document.createElementNS(
      "http://www.w3.org/2000/svg",
      "svg"
    );
    const graphWrapper = document.getElementById('graph-wrapper')

    element.setAttribute("width", graphWrapper.getBoundingClientRect().width);
    graphWrapper.setAttribute("height", window.innerHeight * 0.8);
    element.setAttribute("height", window.innerHeight * 0.8);

    graphWrapper.appendChild(element);

    const reportWindowSize = () => {
      element.setAttribute("width", graphWrapper.getBoundingClientRect().width);
      graphWrapper.setAttribute("height", window.innerHeight * 0.8);
      element.setAttribute("height", window.innerHeight * 0.8);
    };

    window.onresize = reportWindowSize;

    const svg = d3.select("svg");
    const width = Number(svg.attr("width"));
    const height = Number(svg.attr("height"));
    let zoomLevel = 1;

    const simulation = d3
      .forceSimulation(nodesData)
      .force("charge", d3
        .forceManyBody()
        .strength(-4000)
      )
      .force(
        "link",
        d3
          .forceLink(linksData)
          .id((d) => d.id)
          .distance(150)
      )
      .force("center", d3.forceCenter(width / 2, height / 2))
      .stop();

    const g = svg.append("g");
    let link = g.append("g").attr("class", "links").selectAll(".link");
    let node = g.append("g").attr("class", "nodes").selectAll(".node");
    let text = g.append("g").attr("class", "text").selectAll(".text");

    const zoomActions = () => {
      const scale = d3.event.transform;
      zoomLevel = scale.k;
      g.attr("transform", scale);

      const zoomOrKeep = (value) => (scale.k >= 1 ? value / scale.k : value);

      const font = Math.max(Math.round(zoomOrKeep(FONT_SIZE)), 1);

      text.attr("font-size", `${font}px`);
      text.attr("y", (d) => d.y - zoomOrKeep(FONT_BASELINE));
      link.attr("stroke-width", zoomOrKeep(STROKE));
      node.attr("r", zoomOrKeep(RADIUS));
    };

    const ticked = () => {
      node.attr("cx", (d) => d.x).attr("cy", (d) => d.y);
      text
        .attr("x", (d) => d.x)
        .attr("y", (d) => d.y - FONT_BASELINE / zoomLevel);
      link
        .attr("x1", (d) => d.source.x)
        .attr("y1", (d) => d.source.y)
        .attr("x2", (d) => d.target.x)
        .attr("y2", (d) => d.target.y);
    };

    const restart = () => {
      node = node.data(nodesData, (d) => d.id);
      node.exit().remove();
      node = node
        .enter()
        .append("circle")
        .attr("r", RADIUS)
        // .attr("fill", (d) => getNodeColor(d))
        .on("click", onClick)
        .merge(node);

      link = link.data(linksData, (d) => `${d.source.id}-${d.target.id}`);
      link.exit().remove();
      link = link
        .enter()
        .append("line")
        .attr("stroke-width", STROKE)
        .merge(link);

      node.attr("active", (d) => isCurrentPath(d.path) ? true : null);
      text.attr("active", (d) => isCurrentPath(d.path) ? true : null);

      text = text.data(nodesData, (d) => d.label);
      text.exit().remove();
      text = text
        .enter()
        .append("text")
        .text((d) => shorten(d.label.replace(/_*/g, ""), MAX_LABEL_LENGTH))
        .attr("font-size", `${FONT_SIZE}px`)
        .attr("text-anchor", "middle")
        .attr("alignment-baseline", "central")
        .on("click", onClick)
        .merge(text);

      simulation.nodes(nodesData);
      simulation.force("link").links(linksData);
      simulation.alpha(1).restart();
      simulation.stop();

      for (let i = 0; i < TICKS; i++) {
        simulation.tick();
      }

      ticked();
    };

    const zoomHandler = d3
      .zoom()
      .scaleExtent([0.2, 3])
      //.translateExtent([[0,0], [width, height]])
      //.extent([[0, 0], [width, height]])
      .on("zoom", zoomActions);

    zoomHandler(svg);
    restart();

    function isCurrentPath(notePath) {
      return window.location.pathname.includes(notePath)
    }

    function shorten(str, maxLen, separator = ' ') {
      if (str.length <= maxLen) return str;
      return str.substr(0, str.lastIndexOf(separator, maxLen)) + '...';
    }
  </script>
</div>

</main>
      <footer><hr />
<ul>
	<li>Build your own wiki or digital garden using <a href="https://github.com/maximevaillancourt/digital-garden-jekyll-template">maximevaillancourt's digital garden template for Jekyll-based sites</a></li>
	<li>Back to <a href="https://francoalvarado.com">personal and author site</a></li>
	<li>Visit <a href="https://francopub.com">my professional career site</a></li>
	<li><a href="https://francoalvarado.com/colophon#colophon-for-wikis-subdomain">Colophon</a></li>
	<li><a href="https://garden.francoalvarado.com">Digital garden</a></li>
</ul></footer>
    </div>

    <!-- That file is not particularly elegant. This will need a refactor at some point. -->
<style>
  content a.internal-link {
    border-color: #8b88e6;
    background-color: #efefff;
  }

  #tooltip-wrapper {
    background: white;
    padding: 1em;
    border: 1px solid #ddd;
    border-radius: 4px;
    overflow: hidden;
    position: absolute;
    width: 400px;
    height: 250px;
    font-size: 0.8em;
    box-shadow: 0 5px 10px rgba(0,0,0,0.1);
    opacity: 0;
    transition: opacity 100ms;
  }

  #tooltip-wrapper:after {
		content: "";
		position: absolute;
		z-index: 1;
		bottom: 0;
		left: 0;
		pointer-events: none;
		background-image: linear-gradient(to bottom, rgba(255,255,255, 0), rgba(255,255,255, 1) 90%);
		width: 100%;
		height: 75px;
  }
</style>

<div style="opacity: 0; display: none;" id='tooltip-wrapper'>
  <div id='tooltip-content'>
  </div>
</div>

<iframe style="display: none; height: 0; width: 0;" id='link-preview-iframe' src="">
</iframe>

<script>
  var opacityTimeout;
  var contentTimeout;
  var transitionDurationMs = 100;

  var iframe = document.getElementById('link-preview-iframe')
  var tooltipWrapper = document.getElementById('tooltip-wrapper')
  var tooltipContent = document.getElementById('tooltip-content')

  function hideTooltip() {
    opacityTimeout = setTimeout(function() {
      tooltipWrapper.style.opacity = 0;
      contentTimeout = setTimeout(function() {
        tooltipContent.innerHTML = '';
        tooltipWrapper.style.display = 'none';
      }, transitionDurationMs + 1);
    }, transitionDurationMs)
  }

  function showTooltip(event) {
    var elem = event.target;
    var elem_props = elem.getClientRects()[elem.getClientRects().length - 1];
    var top = window.pageYOffset || document.documentElement.scrollTop

    if (event.target.host === window.location.host) {
      iframe.src = event.target.href
      iframe.onload = function() {
        tooltipContentHtml = ''
        tooltipContentHtml += '<div style="font-weight: bold;">' + iframe.contentWindow.document.querySelector('h1').innerHTML + '</div>'
        tooltipContentHtml += iframe.contentWindow.document.querySelector('content').innerHTML

        tooltipContent.innerHTML = tooltipContentHtml

        tooltipWrapper.style.display = 'block';
        setTimeout(function() {
          tooltipWrapper.style.opacity = 1;
        }, 1)
      }

      tooltipWrapper.style.left = elem_props.left - (tooltipWrapper.offsetWidth / 2) + (elem_props.width / 2) + "px";
      if ((window.innerHeight - elem_props.top) < (tooltipWrapper.offsetHeight)) {
          tooltipWrapper.style.top = elem_props.top + top - tooltipWrapper.offsetHeight - 10 + "px";
      } else if ((window.innerHeight - elem_props.top) > (tooltipWrapper.offsetHeight)) {
          tooltipWrapper.style.top = elem_props.top + top + 35 + "px";
      }

      if ((elem_props.left + (elem_props.width / 2)) < (tooltipWrapper.offsetWidth / 2)) {
          tooltipWrapper.style.left = "10px";
      } else if ((document.body.clientWidth - elem_props.left - (elem_props.width / 2)) < (tooltipWrapper.offsetWidth / 2)) {
          tooltipWrapper.style.left = document.body.clientWidth - tooltipWrapper.offsetWidth - 20 + "px";
      }
    }
  }

  function setupListeners(linkElement) {
    linkElement.addEventListener('mouseleave', function(_event) {
      hideTooltip();
    });

    tooltipWrapper.addEventListener('mouseleave', function(_event) {
      hideTooltip();
    });

    linkElement.addEventListener('mouseenter', function(event) {
      clearTimeout(opacityTimeout);
      clearTimeout(contentTimeout);
      showTooltip(event);
    });

    tooltipWrapper.addEventListener('mouseenter', function(event) {
      clearTimeout(opacityTimeout);
      clearTimeout(contentTimeout);
    });
  }

  document.querySelectorAll('content a').forEach(setupListeners);
</script>

  </body>
</html>
